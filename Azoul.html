<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Azoul · Manager Dashboard</title>
<style>
  body{
    margin:0; font-family:system-ui; background:#0d162b; color:white;
  }
  .wrap{ max-width:900px; margin:auto; padding:24px }
  h1{ font-size:28px; font-weight:800; margin-bottom:8px }
  .card{
    background:white; color:#1a1a1a; padding:16px;
    border-radius:12px; margin-bottom:16px;
    box-shadow:0 4px 16px rgba(0,0,0,.25);
  }
  label{ font-size:13px; margin-bottom:6px; display:block }
  .input{
    width:100%; padding:12px; border-radius:8px;
    border:1px solid #ccc; margin-bottom:12px;
  }
  .btn{
    background:#2363ff; color:white; border:none;
    padding:12px 16px; border-radius:8px;
    font-weight:700; cursor:pointer;
  }
  .filters{
    display:flex; gap:12px; margin-bottom:20px;
  }
  select{ padding:10px; border-radius:8px; border:1px solid #ccc }
</style>
</head>
<body>

<div class="wrap" id="loginPage">
  <h1>Manager Login</h1>
  <label>Email</label>
  <input id="mEmail" class="input" type="email" placeholder="manager@example.com">

  <label>Manager Code</label>
  <input id="mCode" class="input" type="password" placeholder="Enter access code">

  <button class="btn" id="loginBtn">View Reports</button>
</div>

<div class="wrap" id="dashboardPage" style="display:none;">
  <h1>Employee Reports</h1>

  <div class="filters">
    <select id="teamFilter">
      <option value="all">All Teams</option>
    </select>

    <select id="issueFilter">
      <option value="all">All Issues</option>
      <option value="low-pay">Low Pay</option>
      <option value="harassment">Harassment</option>
      <option value="burnout">Burnout</option>
      <option value="overtime">Overtime</option>
      <option value="safety">Safety</option>
      <option value="management">Management</option>
      <option value="career">Career Growth</option>
      <option value="benefits">Benefits</option>
      <option value="culture">Culture</option>
    </select>
  </div>

  <div id="reports"></div>
</div>

<script>
  const loginPage = document.querySelector("#loginPage");
  const dashboardPage = document.querySelector("#dashboardPage");
  const reportsEl = document.querySelector("#reports");
  const teamFilter = document.querySelector("#teamFilter");
  const issueFilter = document.querySelector("#issueFilter");

  const MANAGER_CODE = "azoul-admin-2025";

  document.querySelector("#loginBtn").onclick = () => {
    const email = document.querySelector("#mEmail").value.trim();
    const code = document.querySelector("#mCode").value.trim();

    if (!email || !code) return alert("Fill all fields");
    if (code !== MANAGER_CODE) return alert("Wrong manager code");

    loginPage.style.display = "none";
    dashboardPage.style.display = "block";

    loadReports();
  };

  function loadReports() {
    const data = JSON.parse(localStorage.getItem("azoul_reports") || "[]");

    // populate team filter
    const teams = [...new Set(data.map(r => r.user.team))];
    teamFilter.innerHTML = `<option value="all">All Teams</option>` +
      teams.map(t => `<option value="${t}">${t}</option>`).join("");

    renderReports(data);

    teamFilter.onchange = () => renderReports(data);
    issueFilter.onchange = () => renderReports(data);
  }

  function renderReports(data) {
    const t = teamFilter.value;
    const i = issueFilter.value;

    const filtered = data.filter(r => {
      const teamOK = (t === "all" || r.user.team === t);
      const issueOK = (i === "all" || r.selections.includes(i));
      return teamOK && issueOK;
    });

    reportsEl.innerHTML = filtered.map(r => `
      <div class="card">
        <strong>Employee:</strong> ${r.user.email}<br>
        <strong>Team:</strong> ${r.user.team}<br>
        <strong>Issues:</strong> ${r.selections.join(", ")}<br>
        <strong>Other:</strong> ${r.other || "—"}<br>
        <strong>Date:</strong> ${new Date(r.savedAt).toLocaleString()}
      </div>
    `).join("");
  }
</script>

</body>
</html>
